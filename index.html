<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>ØªÙ…Ù‡ÙŠØ¯ Ø§Ù„Ø¯Ù„Ø§Ø¦Ù„ â€” Ø§Ù„Ù„Ø§Ù…Ø´ÙŠ (Ù†Ø³Ø®Ø© Ù…ÙˆØ¨Ø§ÙŠÙ„)</title>

  <!--
    Mobile-first, single-file site.
    Features:
    - Bottom navigation for phone
    - One-tap accordion toggles (no accidental close while selecting text)
    - Search with results list + jump + highlight
    - Reading mode + simple mode + theme toggle
    - Persist open chapters + settings via localStorage
    - Print/PDF clean styles
  -->

  <style>
    :root{
      --bg0:#0f2027;
      --bg1:#203a43;
      --bg2:#2c5364;

      --paper:#ffffff;
      --paper2:#f7f9fc;
      --ink:#0f172a;
      --muted:#475569;

      --brand:#1e3c72;
      --brand2:#2a5298;
      --gold:#ffd700;

      --radius:16px;
      --shadow: 0 10px 24px rgba(0,0,0,.12);

      --tap: 48px; /* minimum tap target */
      --line: 2.05;
      --fs: 16px;

      --border: rgba(15, 23, 42, .12);
      --card: rgba(255,255,255,.96);
    }

    html{ scroll-behavior:smooth; }
    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: 'Amiri','Traditional Arabic', serif;
      font-size: var(--fs);
      line-height: var(--line);
      color: var(--ink);
      background: linear-gradient(135deg, var(--bg0) 0%, var(--bg1) 50%, var(--bg2) 100%);
      min-height:100vh;
      padding-bottom: calc(84px + env(safe-area-inset-bottom)); /* space for bottom bar */
      -webkit-tap-highlight-color: transparent;
    }

    /* ===== Top app bar (compact on phone) ===== */
    .appbar{
      position: sticky;
      top:0;
      z-index: 1500;
      backdrop-filter: blur(10px);
      background: rgba(255,255,255,.92);
      border-bottom: 1px solid rgba(0,0,0,.08);
    }
    .appbar-inner{
      max-width: 980px;
      margin: 0 auto;
      padding: .65rem .85rem;
      display:flex;
      align-items:center;
      gap:.75rem;
      justify-content: space-between;
    }
    .brand{
      display:flex;
      align-items:center;
      gap:.65rem;
      min-width:0;
    }
    .logo{
      width: 38px;
      height: 38px;
      border-radius: 12px;
      background: linear-gradient(135deg, var(--brand) 0%, var(--brand2) 100%);
      box-shadow: 0 8px 18px rgba(30,60,114,.25);
      display:grid;
      place-items:center;
      color: white;
      font-weight: 900;
      flex: 0 0 auto;
    }
    .titles{
      min-width:0;
    }
    .titles h1{
      margin:0;
      font-size: 1.05rem;
      line-height: 1.2;
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .titles .sub{
      margin-top:.1rem;
      font-size: .85rem;
      color: var(--muted);
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }

    .app-actions{
      display:flex;
      align-items:center;
      gap:.5rem;
      flex:0 0 auto;
    }

    .iconbtn{
      width: var(--tap);
      height: var(--tap);
      border:1px solid rgba(0,0,0,.10);
      border-radius: 14px;
      background: rgba(255,255,255,.95);
      display:grid;
      place-items:center;
      cursor:pointer;
      user-select:none;
      font-size: 18px;
    }
    .iconbtn:active{ transform: scale(.98); }

    /* ===== Container ===== */
    .wrap{
      max-width: 980px;
      margin: 0 auto;
      padding: 14px 12px;
    }

    /* ===== Hero ===== */
    .hero{
      background: rgba(255,255,255,.92);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      border: 1px solid rgba(0,0,0,.06);
    }
    .hero-top{
      padding: 1.1rem 1rem;
      background: linear-gradient(135deg, rgba(30,60,114,.98) 0%, rgba(42,82,152,.98) 100%);
      color: white;
      position: relative;
    }
    .hero-top:after{
      content:"";
      position:absolute;
      inset:0;
      background: radial-gradient(circle at 20% 20%, rgba(255,215,0,.22), transparent 45%),
                  radial-gradient(circle at 80% 35%, rgba(255,255,255,.14), transparent 50%);
      pointer-events:none;
    }
    .hero-top h2{
      margin:0 0 .25rem;
      font-size: 1.35rem;
      position:relative;
      z-index:1;
    }
    .hero-top p{
      margin:0;
      opacity:.95;
      position:relative;
      z-index:1;
      font-size: .98rem;
    }
    .hero-meta{
      padding: .9rem 1rem;
      display:flex;
      flex-direction: column;
      gap:.55rem;
      background: rgba(255,255,255,.92);
    }
    .chiprow{
      display:flex;
      flex-wrap: wrap;
      gap: .5rem;
    }
    .chip{
      padding: .35rem .7rem;
      border-radius: 999px;
      background: rgba(30,60,114,.08);
      border: 1px solid rgba(30,60,114,.18);
      color: var(--brand);
      font-weight: 900;
      font-size: .92rem;
    }

    /* ===== Search ===== */
    .searchbox{
      display:flex;
      gap:.6rem;
      align-items:center;
      margin-top:.25rem;
    }
    .searchbox input{
      flex:1;
      height: var(--tap);
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,.14);
      padding: 0 14px;
      font-family: inherit;
      font-size: 1rem;
      background: white;
      outline:none;
    }
    .searchbox input:focus{
      border-color: rgba(30,60,114,.45);
      box-shadow: 0 0 0 4px rgba(30,60,114,.14);
    }
    .pillbtn{
      height: var(--tap);
      padding: 0 14px;
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,.10);
      background: linear-gradient(135deg, var(--brand) 0%, var(--brand2) 100%);
      color:white;
      font-weight: 900;
      cursor:pointer;
      white-space: nowrap;
    }
    .pillbtn.secondary{
      background: white;
      color: var(--brand);
      border: 1px solid rgba(30,60,114,.25);
    }
    .pillbtn:active{ transform: scale(.99); }

    /* ===== Sections ===== */
    .section{
      margin-top: 14px;
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1px solid rgba(0,0,0,.06);
      overflow:hidden;
    }
    .section-head{
      padding: .95rem 1rem;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap:.75rem;
      background: rgba(255,255,255,.96);
      border-bottom: 1px solid rgba(0,0,0,.06);
    }
    .section-head h3{
      margin:0;
      font-size: 1.15rem;
      color: var(--brand);
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }
    .section-body{ padding: 1rem; }

    .note{
      background: rgba(30,60,114,.06);
      border: 1px solid rgba(30,60,114,.14);
      border-radius: 14px;
      padding: .9rem;
      color: #0b224c;
    }
    .quote{
      background: rgba(255,152,0,.08);
      border: 1px solid rgba(255,152,0,.18);
      border-right: 5px solid rgba(255,152,0,.65);
      border-radius: 14px;
      padding: .9rem;
      margin-top: .9rem;
      position: relative;
      font-style: italic;
    }
    .quote:before{
      content:"â";
      position:absolute;
      top: -8px;
      right: 10px;
      opacity:.25;
      font-size: 2.4rem;
      color: #ff9800;
    }
    .ref{
      background: rgba(156,39,176,.08);
      border: 1px solid rgba(156,39,176,.18);
      border-right: 5px solid rgba(156,39,176,.55);
      border-radius: 14px;
      padding: .85rem;
      margin-top:.9rem;
      color: #3b0f46;
      font-size: .98rem;
    }
    mark.hl{
      background: #ffed4e;
      border-radius: 4px;
      padding: 0 .12rem;
    }

    /* ===== Accordion chapters ===== */
    .chapters{ display:flex; flex-direction: column; gap:.75rem; }
    .chapter{
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,.10);
      background: rgba(255,255,255,.98);
      overflow:hidden;
    }
    .ch-head{
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap:.75rem;
      padding: .85rem .9rem;
    }
    .ch-title{
      margin:0;
      font-weight: 900;
      font-size: 1.05rem;
      color: var(--brand);
      flex:1;
      min-width:0;
    }
    .toggle{
      height: 42px;
      padding: 0 14px;
      border-radius: 999px;
      border: 1px solid rgba(30,60,114,.22);
      background: rgba(30,60,114,.08);
      color: var(--brand);
      font-weight: 900;
      cursor:pointer;
      flex: 0 0 auto;
    }
    .toggle:active{ transform: scale(.99); }

    .ch-body{
      display:none;
      padding: 0 .95rem .95rem;
      border-top: 1px dashed rgba(0,0,0,.14);
    }
    .chapter.active .ch-body{ display:block; }

    /* ===== Search results panel ===== */
    .results{
      display:none;
      margin-top: 10px;
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,.10);
      background: rgba(255,255,255,.98);
      overflow:hidden;
    }
    .results-head{
      padding: .7rem .9rem;
      display:flex;
      align-items:center;
      justify-content: space-between;
      gap:.75rem;
      border-bottom: 1px dashed rgba(0,0,0,.14);
    }
    .results-head strong{ color: var(--brand); }
    .results-list{ padding: .65rem; display:flex; flex-direction:column; gap:.55rem; }
    .r-item{
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,.10);
      background: rgba(30,60,114,.06);
      padding: .7rem .8rem;
      cursor:pointer;
    }
    .r-item:active{ transform: scale(.99); }
    .r-item .rt{ font-weight: 900; color: var(--brand); margin:0 0 .2rem; font-size: 1.0rem; }
    .r-item .rs{ margin:0; color: var(--muted); font-size: .95rem; }

    /* ===== Bottom bar (phone) ===== */
    .bbar{
      position: fixed;
      left: 12px;
      right: 12px;
      bottom: calc(12px + env(safe-area-inset-bottom));
      z-index: 2000;
      display:flex;
      gap:10px;
      padding: 10px;
      border-radius: 18px;
      background: rgba(255,255,255,.92);
      box-shadow: 0 12px 28px rgba(0,0,0,.22);
      border: 1px solid rgba(0,0,0,.08);
      backdrop-filter: blur(10px);
    }
    .bbar button{
      flex:1;
      height: 46px;
      border-radius: 14px;
      border: 1px solid rgba(30,60,114,.18);
      background: rgba(30,60,114,.08);
      color: var(--brand);
      font-weight: 900;
      font-size: 15px;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:.35rem;
      user-select:none;
    }
    .bbar button:active{ transform: scale(.99); }

    /* ===== Modes ===== */
    body.reading{
      --fs: 17px;
      --line: 2.2;
    }
    body.simple .note,
    body.simple .quote,
    body.simple .ref,
    body.simple .r-item{
      background: rgba(255,255,255,.98) !important;
    }
    body.simple .hero-top{
      background: rgba(30,60,114,.98);
    }

    /* ===== Dark theme ===== */
    :root[data-theme="dark"]{
      --paper: rgba(13,18,24,.94);
      --paper2: rgba(13,18,24,.92);
      --ink: #e7eef7;
      --muted: #b6c2d3;
      --border: rgba(255,255,255,.12);
      --card: rgba(13,18,24,.92);
    }
    :root[data-theme="dark"] .appbar{ background: rgba(13,18,24,.90); border-bottom-color: rgba(255,255,255,.10); }
    :root[data-theme="dark"] .iconbtn{ background: rgba(13,18,24,.92); border-color: rgba(255,255,255,.12); color: #e7eef7; }
    :root[data-theme="dark"] .hero{ background: rgba(13,18,24,.92); border-color: rgba(255,255,255,.10); }
    :root[data-theme="dark"] .hero-meta{ background: rgba(13,18,24,.92); }
    :root[data-theme="dark"] .chip{ background: rgba(255,215,0,.12); border-color: rgba(255,215,0,.22); color: #ffd700; }
    :root[data-theme="dark"] .section{ border-color: rgba(255,255,255,.10); }
    :root[data-theme="dark"] .section-head{ background: rgba(13,18,24,.92); border-bottom-color: rgba(255,255,255,.10); }
    :root[data-theme="dark"] .note{ background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.12); color: #e7eef7; }
    :root[data-theme="dark"] .quote{ background: rgba(255,152,0,.10); border-color: rgba(255,152,0,.18); }
    :root[data-theme="dark"] .ref{ background: rgba(156,39,176,.12); border-color: rgba(156,39,176,.22); color: #efe0f2; }
    :root[data-theme="dark"] .chapter{ background: rgba(13,18,24,.92); border-color: rgba(255,255,255,.10); }
    :root[data-theme="dark"] .results{ background: rgba(13,18,24,.92); border-color: rgba(255,255,255,.10); }
    :root[data-theme="dark"] .r-item{ background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.10); }
    :root[data-theme="dark"] .searchbox input{ background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.12); color: #e7eef7; }
    :root[data-theme="dark"] .bbar{ background: rgba(13,18,24,.90); border-color: rgba(255,255,255,.12); }
    :root[data-theme="dark"] .bbar button{ background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.12); color: #e7eef7; }

    /* ===== Desktop tweaks ===== */
    @media (min-width: 900px){
      body{ padding-bottom: 18px; }
      .bbar{ display:none; }
      .wrap{ padding: 18px 14px; }
      .appbar-inner{ padding: .7rem 1rem; }
      .hero-top h2{ font-size: 1.55rem; }
      .searchbox input{ font-size: 1.02rem; }
    }

    /* ===== Print/PDF ===== */
    @media print{
      .appbar, .bbar, .iconbtn, .pillbtn, .results{ display:none !important; }
      body{ background: white !important; padding-bottom: 0 !important; }
      .hero, .section{ box-shadow:none !important; }
      .ch-body{ display:block !important; }
    }
  </style>
</head>

<body>
  <!-- Top app bar -->
  <header class="appbar" id="top">
    <div class="appbar-inner">
      <div class="brand" title="ØªÙ…Ù‡ÙŠØ¯ Ø§Ù„Ø¯Ù„Ø§Ø¦Ù„">
        <div class="logo">Øª</div>
        <div class="titles">
          <h1>ØªÙ…Ù‡ÙŠØ¯ Ø§Ù„Ø¯Ù„Ø§Ø¦Ù„ â€” Ø§Ù„Ù„Ø§Ù…Ø´ÙŠ</h1>
          <div class="sub">Ù†Ø³Ø®Ø© Ù…Ø±ÙŠØ­Ø© Ù„Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ â€¢ Ø¨Ø­Ø« Ø³Ø±ÙŠØ¹ â€¢ ÙˆØ¶Ø¹ Ù‚Ø±Ø§Ø¡Ø©</div>
        </div>
      </div>
      <div class="app-actions">
        <button class="iconbtn" id="btnTheme" type="button" title="ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹">ğŸŒ™</button>
        <button class="iconbtn" id="btnReading" type="button" title="ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©">ğŸ‘“</button>
        <button class="iconbtn" id="btnSimple" type="button" title="Ù…Ø¸Ù‡Ø± Ø¨Ø³ÙŠØ·">âœ¨</button>
      </div>
    </div>
  </header>

  <main class="wrap">
    <!-- Hero -->
    <section class="hero" aria-label="Ø§Ù„ØºÙ„Ø§Ù">
      <div class="hero-top">
        <h2>ØªÙ…Ù‡ÙŠØ¯ Ø§Ù„Ø¯Ù„Ø§Ø¦Ù„ ÙÙŠ ØªØ­Ù‚ÙŠÙ‚ Ù…Ø³Ø§Ø¦Ù„ Ø¹Ù„Ù… Ø§Ù„ÙƒÙ„Ø§Ù…</h2>
        <p>Ø§Ù„Ø´ÙŠØ® Ø§Ù„Ø¥Ù…Ø§Ù… Ø£Ø¨Ùˆ Ø§Ù„Ø«Ù†Ø§Ø¡ Ù…Ø­Ù…ÙˆØ¯ Ø¨Ù† Ø²ÙŠØ¯ Ø§Ù„Ù„Ø§Ù…Ø´ÙŠ</p>
      </div>
      <div class="hero-meta">
        <div class="chiprow">
          <span class="chip">ğŸ“± Mobile-first</span>
          <span class="chip">ğŸ” Ø¨Ø­Ø« + Ù†ØªØ§Ø¦Ø¬</span>
          <span class="chip">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø­Ø§Ù„Ø©</span>
          <span class="chip">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©/PDF</span>
        </div>

        <div class="searchbox" role="search">
          <input id="q" type="search" placeholder="Ø§Ø¨Ø­Ø«â€¦ Ù…Ø«Ø§Ù„: Ø§Ù„Ø¯Ù„ÙŠÙ„ØŒ Ø§Ù„Ø­ÙƒÙ…ØŒ Ø­Ø¯ÙˆØ« Ø§Ù„Ø¹Ø§Ù„Ù…" autocomplete="off" />
          <button class="pillbtn secondary" id="btnClear" type="button">Ù…Ø³Ø­</button>
          <button class="pillbtn" id="btnOpenAll" type="button">ÙØªØ­ Ø§Ù„ÙƒÙ„</button>
        </div>

        <div class="results" id="results" aria-live="polite">
          <div class="results-head">
            <strong>Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø¨Ø­Ø«</strong>
            <span id="rmeta">â€”</span>
          </div>
          <div class="results-list" id="rlist"></div>
        </div>
      </div>
    </section>

    <!-- Biography -->
    <section class="section" id="biography">
      <div class="section-head">
        <h3>ØªØ±Ø¬Ù…Ø© Ø§Ù„Ù…Ø¤Ù„Ù</h3>
        <button class="pillbtn secondary" type="button" data-jump="#biography">â†©ï¸</button>
      </div>
      <div class="section-body">
        <div class="note">
          <strong>Ù‡Ùˆ Ø§Ù„Ø´ÙŠØ® Ø§Ù„Ø¥Ù…Ø§Ù… Ø§Ù„Ø£Ø³ØªØ§Ø° Ø§Ù„Ø¬Ù„ÙŠÙ„</strong> Ø³ÙŠÙ Ø§Ù„Ø­Ù‚ Ù†Ø§ØµØ± Ø§Ù„Ø´Ø±ÙŠØ¹Ø©ØŒ Ø£Ø¨Ùˆ Ø§Ù„Ø«Ù†Ø§Ø¡ Ù…Ø­Ù…ÙˆØ¯ Ø¨Ù† Ø²ÙŠØ¯ Ø§Ù„Ù„Ø§Ù…Ø´ÙŠ.
          Ù†Ø´Ø£ ÙÙŠ Ø¨Ù„Ø§Ø¯ Ù…Ø§ ÙˆØ±Ø§Ø¡ Ø§Ù„Ù†Ù‡Ø±ØŒ ÙˆÙŠÙ†Ø³Ø¨ Ø¥Ù„Ù‰ Â«Ù„Ø§Ù…Ø´Â» Ù…Ù† Ù‚Ø±Ù‰ ÙÙØ±Ù’ØºÙØ§Ù†ÙØ©Ù.
        </div>

        <div class="quote">
          ÙƒØ§Ù† ÙŠÙÙ‚Ø§Ø±Ù† Ø£Ø­ÙŠØ§Ù†Ø§Ù‹ Ø¨ÙŠÙ† Ø£Ù‚ÙˆØ§Ù„ ÙÙ‚Ù‡Ø§Ø¡ Ø³Ù…Ø±Ù‚Ù†Ø¯ ÙˆÙÙ‚Ù‡Ø§Ø¡ Ø§Ù„Ø¹Ø±Ø§Ù‚ ÙˆÙŠØ°ÙƒØ± Ø§Ø®ØªÙ„Ø§Ù Ù…Ù†Ø§Ù‡Ø¬Ù‡Ù… ÙÙŠ Ø¨Ø¹Ø¶ Ù…Ø³Ø§Ø¦Ù„ Ø§Ù„Ø£ØµÙˆÙ„.
        </div>

        <div class="ref">
          ÙˆØ±Ø¯ ÙÙŠ Ø¨Ø¹Ø¶ Ø§Ù„Ù†Ø³Ø® Ø£Ù†Ù‡ ØªÙˆÙÙŠ Ø³Ù†Ø© <b>522Ù‡Ù€</b> (Ù…Ø¹ Ø§Ø®ØªÙ„Ø§Ù ÙÙŠ Ø¶Ø¨Ø· Ø§Ù„ÙŠÙˆÙ… ÙÙŠ Ø¨Ø¹Ø¶ Ø§Ù„Ù†Ù‚ÙˆÙ„).
        </div>
      </div>
    </section>

    <!-- Introduction -->
    <section class="section" id="intro">
      <div class="section-head">
        <h3>Ù…Ø¯Ø®Ù„</h3>
        <button class="pillbtn secondary" type="button" data-jump="#intro">â†©ï¸</button>
      </div>
      <div class="section-body">
        <div class="note">
          Ù‚Ø¨Ù„ Ø§Ù„Ø´Ø±ÙˆØ¹: ØªØ¹Ø±ÙŠÙ Ø¹Ù„Ù… Ø§Ù„ÙƒÙ„Ø§Ù… ÙˆÙ…ÙˆØ¶ÙˆØ¹Ù‡ ÙˆØºØ§ÙŠØªÙ‡ØŒ Ø­ØªÙ‰ Ù„Ø§ ÙŠØªÙˆÙ‡ Ø§Ù„Ø·Ø§Ù„Ø¨ Ù‚Ø¨Ù„ Ø£Ù† ÙŠØ¨Ø¯Ø£.
        </div>
        <div class="chapters">
          <div class="chapter" id="kalam_def">
            <div class="ch-head">
              <div class="ch-title">ØªØ¹Ø±ÙŠÙ Ø¹Ù„Ù… Ø§Ù„ÙƒÙ„Ø§Ù…</div>
              <button class="toggle" type="button">ÙØªØ­</button>
            </div>
            <div class="ch-body">
              <p><b>Ø¨Ø­Ø³Ø¨ Ù…ÙˆØ¶ÙˆØ¹Ù‡:</b> Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø°Ø§Øª Ø§Ù„Ù„Ù‡ ÙˆØµÙØ§ØªÙ‡ ÙˆØ£Ø­ÙˆØ§Ù„ Ø§Ù„Ù…Ù…ÙƒÙ†Ø§Øª Ù…Ù† Ø§Ù„Ù…Ø¨Ø¯Ø£ ÙˆØ§Ù„Ù…Ø¹Ø§Ø¯.</p>
              <p><b>Ø¨Ø­Ø³Ø¨ ØºØ§ÙŠØªÙ‡:</b> Ø§Ù„Ø§Ù‚ØªØ¯Ø§Ø± Ø¹Ù„Ù‰ Ø¥Ø«Ø¨Ø§Øª Ø§Ù„Ø¹Ù‚Ø§Ø¦Ø¯ Ø¨Ø¥ÙŠØ±Ø§Ø¯ Ø§Ù„Ø­Ø¬Ø¬ ÙˆØ¯ÙØ¹ Ø§Ù„Ø´Ø¨Ù‡.</p>
            </div>
          </div>

          <div class="chapter" id="kalam_goal">
            <div class="ch-head">
              <div class="ch-title">ØºØ§ÙŠØ© Ù‡Ø°Ø§ Ø§Ù„ÙÙ†</div>
              <button class="toggle" type="button">ÙØªØ­</button>
            </div>
            <div class="ch-body">
              <p>Ù¡) Ø§Ù„ØªØ±Ù‚ÙŠ Ù…Ù† Ø§Ù„ØªÙ‚Ù„ÙŠØ¯ Ø¥Ù„Ù‰ Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù†. Ù¢) Ø¥Ø±Ø´Ø§Ø¯ Ø§Ù„Ù…Ø³ØªØ±Ø´Ø¯ÙŠÙ†. Ù£) Ø­ÙØ¸ Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø¯ÙŠÙ†. Ù¤) Ø£Ø³Ø§Ø³ Ø§Ù„Ø¹Ù„ÙˆÙ… Ø§Ù„Ø´Ø±Ø¹ÙŠØ©.</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Definitions -->
    <section class="section" id="definitions">
      <div class="section-head">
        <h3>Ø§Ù„ØªØ¹Ø±ÙŠÙØ§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h3>
        <button class="pillbtn secondary" type="button" data-jump="#definitions">â†©ï¸</button>
      </div>
      <div class="section-body">
        <div class="chapters">
          <div class="chapter" id="dalil">
            <div class="ch-head">
              <div class="ch-title">Ø§Ù„Ø¯Ù„ÙŠÙ„</div>
              <button class="toggle" type="button">ÙØªØ­</button>
            </div>
            <div class="ch-body">
              <div class="note"><b>Ù„ØºØ©:</b> Ø§Ù„Ù…Ø±Ø´Ø¯. <b>Ø§ØµØ·Ù„Ø§Ø­Ø§Ù‹:</b> Ù…Ø§ ÙŠÙØªÙˆØµÙ„ Ø¨Ù‡ Ù…Ù† Ù…Ø¹Ù„ÙˆÙ… Ø¥Ù„Ù‰ Ù…Ø·Ù„ÙˆØ¨ Ø¨Ø¥Ø­ÙƒØ§Ù… Ø§Ù„Ù†Ø¸Ø±.</div>
              <div class="ref">
                <b>Ø£Ù‚Ø³Ø§Ù…Ù‡:</b> Ø¹Ù‚Ù„ÙŠ (Ù…Ù‚Ø¯Ù…Ø§ØªÙ‡ Ø¹Ù‚Ù„ÙŠØ©) â€” Ø³Ù…Ø¹ÙŠ (Ù…Ø±ÙƒØ¨ Ù…Ù† Ø¹Ù‚Ù„ ÙˆØ³Ù…Ø¹).
              </div>
            </div>
          </div>

          <div class="chapter" id="hukm">
            <div class="ch-head">
              <div class="ch-title">Ø§Ù„Ø­ÙƒÙ…</div>
              <button class="toggle" type="button">ÙØªØ­</button>
            </div>
            <div class="ch-body">
              <div class="note">
                <b>Ø¹Ù†Ø¯ Ø£Ù‡Ù„ Ø§Ù„ÙÙ†:</b> Ø¥Ø«Ø¨Ø§Øª Ø£Ù…Ø± Ù„Ø£Ù…Ø± Ø£Ùˆ Ù†ÙÙŠÙ‡ Ø¹Ù†Ù‡. <br/>
                <b>Ø£Ù‚Ø³Ø§Ù…Ù‡ (Ø§Ù„Ø¹Ù‚Ù„ÙŠ):</b> ÙˆØ¬ÙˆØ¨ â€” Ø§Ø³ØªØ­Ø§Ù„Ø© â€” Ø¥Ù…ÙƒØ§Ù†.
              </div>
            </div>
          </div>

          <div class="chapter" id="wajib">
            <div class="ch-head">
              <div class="ch-title">Ø§Ù„ÙˆØ§Ø¬Ø¨ ÙˆØ§Ù„Ù…Ø³ØªØ­ÙŠÙ„ ÙˆØ§Ù„Ù…Ù…ÙƒÙ†</div>
              <button class="toggle" type="button">ÙØªØ­</button>
            </div>
            <div class="ch-body">
              <div class="note">
                <b>Ø§Ù„ÙˆØ§Ø¬Ø¨:</b> Ù…Ø§ Ù„Ø§ ÙŠÙ‚Ø¨Ù„ Ø§Ù„Ø§Ù†ØªÙØ§Ø¡. <br/>
                <b>Ø§Ù„Ù…Ø³ØªØ­ÙŠÙ„:</b> Ù…Ø§ Ù„Ø§ ÙŠÙ‚Ø¨Ù„ Ø§Ù„Ø«Ø¨ÙˆØª. <br/>
                <b>Ø§Ù„Ù…Ù…ÙƒÙ†:</b> Ù…Ø§ ÙŠÙ‚Ø¨Ù„ Ø§Ù„Ø«Ø¨ÙˆØª ÙˆØ§Ù„Ø§Ù†ØªÙØ§Ø¡.
              </div>
              <div class="ref">
                <b>ØªÙ†Ø¨ÙŠÙ‡:</b> Ø§Ù„ÙˆØ§Ø¬Ø¨ Ø¨Ø§Ù„ØºÙŠØ± ÙˆØ§Ù„Ù…Ù…ØªÙ†Ø¹ Ø¨Ø§Ù„ØºÙŠØ± Ù…Ù…ÙƒÙ†Ø§Ù† Ø¨Ø§Ù„Ø°Ø§Øª ÙÙŠ Ø§Ù„Ø£ØµÙ„.
              </div>
            </div>
          </div>

          <div class="chapter" id="ilm">
            <div class="ch-head">
              <div class="ch-title">Ø§Ù„Ø¹Ù„Ù… (ØªÙ…Ù‡ÙŠØ¯)</div>
              <button class="toggle" type="button">ÙØªØ­</button>
            </div>
            <div class="ch-body">
              <div class="note">
                ØªÙØ°ÙƒØ± Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø¹Ù„Ù…: <b>Ø§Ù„Ø­ÙˆØ§Ø³ Ø§Ù„Ø³Ù„ÙŠÙ…Ø©</b>ØŒ <b>Ø§Ù„Ø¹Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø³ØªÙ‚ÙŠÙ…Ø©</b>ØŒ <b>Ø§Ù„Ø®Ø¨Ø± Ø§Ù„ØµØ§Ø¯Ù‚</b>.
              </div>
              <div class="quote">
                Ø¥Ø°Ø§ Ø£Ù„ØºÙŠØªÙ Ø§Ù„Ø¹Ù‚Ù„ ÙƒÙ„Ù‡â€¦ Ø¨Ø£ÙŠ Ø´ÙŠØ¡ Ø³ØªÙØ«Ø¨Øª Ø£Ù† â€œØ§Ù„Ø¹Ù‚Ù„ Ù„Ø§ ÙŠÙ†ÙØ¹â€ØŸ
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Chapters -->
    <section class="section" id="chapters">
      <div class="section-head">
        <h3>ÙØµÙˆÙ„ Ù…Ø®ØªØ§Ø±Ø©</h3>
        <button class="pillbtn secondary" type="button" data-jump="#chapters">â†©ï¸</button>
      </div>
      <div class="section-body">
        <div class="chapters">
          <div class="chapter" id="haqaiq">
            <div class="ch-head">
              <div class="ch-title">ÙØµÙ„ ÙÙŠ Ø«Ø¨ÙˆØª Ø­Ù‚Ø§Ø¦Ù‚ Ø§Ù„Ø£Ø´ÙŠØ§Ø¡</div>
              <button class="toggle" type="button">ÙØªØ­</button>
            </div>
            <div class="ch-body">
              <div class="note">Ø­Ù‚Ø§Ø¦Ù‚ Ø§Ù„Ø£Ø´ÙŠØ§Ø¡ Ø«Ø§Ø¨ØªØ© ÙˆÙ‡Ùˆ Ù…Ø°Ù‡Ø¨ Ø¹Ø§Ù…Ø© Ø§Ù„Ø¹Ù‚Ù„Ø§Ø¡.</div>
              <div class="quote">
                Ù‡Ù„ Ù„Ù…Ø°Ù‡Ø¨ÙƒÙ… â€œÙ†ÙÙŠ Ø§Ù„Ø­Ù‚Ø§Ø¦Ù‚â€ Ø­Ù‚ÙŠÙ‚Ø©ØŸ Ø¥Ù† Ù‚Ø§Ù„ÙˆØ§ Ù„Ø§ØŒ Ø³Ù‚Ø·. ÙˆØ¥Ù† Ù‚Ø§Ù„ÙˆØ§ Ù†Ø¹Ù…ØŒ Ø£Ø«Ø¨ØªÙˆØ§ Ø­Ù‚ÙŠÙ‚Ø© Ø´ÙŠØ¡.
              </div>
              <div class="ref">
                Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ù„Ø§Ø£Ø¯Ø±ÙŠØ©: â€œÙ„Ø§ Ù†Ø¯Ø±ÙŠâ€ Ø¥Ù† ÙƒØ§Ù†Øª Ø¨Ù„Ø§ Ø­Ù‚ÙŠÙ‚Ø© ÙÙ„Ø§ Ù…Ù†Ø§Ø¸Ø±Ø©ØŒ ÙˆØ¥Ù† ÙƒØ§Ù†Øª Ù„Ù‡Ø§ Ø­Ù‚ÙŠÙ‚Ø© ÙÙ‚Ø¯ Ø«Ø¨ØªØª Ø­Ù‚ÙŠÙ‚Ø© Ø´ÙŠØ¡.
              </div>
            </div>
          </div>

          <div class="chapter" id="huduth">
            <div class="ch-head">
              <div class="ch-title">ÙØµÙ„ ÙÙŠ Ø¥Ø«Ø¨Ø§Øª Ø­Ø¯ÙˆØ« Ø§Ù„Ø¹Ø§Ù„Ù… ÙˆØ«Ø¨ÙˆØª Ø§Ù„ØµØ§Ù†Ø¹ ÙˆÙ‚Ø¯Ù…Ù‡</div>
              <button class="toggle" type="button">ÙØªØ­</button>
            </div>
            <div class="ch-body">
              <div class="note">
                <b>Ø§Ù„Ø¹Ø§Ù„Ù…:</b> Ù…Ø§ Ø³ÙˆÙ‰ Ø§Ù„Ù„Ù‡ ØªØ¹Ø§Ù„Ù‰. ÙˆÙŠÙØ°ÙƒØ± ØªÙ‚Ø³ÙŠÙ…Ù‡ Ø¥Ù„Ù‰ Ø£Ø¹Ø±Ø§Ø¶ ÙˆØ¬ÙˆØ§Ù‡Ø± ÙˆØ£Ø¬Ø³Ø§Ù… ÙÙŠ Ø§ØµØ·Ù„Ø§Ø­ Ø§Ù„Ù…ØªÙƒÙ„Ù…ÙŠÙ†.
              </div>
              <div class="quote">
                Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ ØªØªØ¹Ø§Ù‚Ø¨ (Ø­Ø±ÙƒØ©/Ø³ÙƒÙˆÙ†ØŒ Ø³ÙˆØ§Ø¯/Ø¨ÙŠØ§Ø¶) ÙÙ‡ÙŠ Ø­Ø§Ø¯Ø«Ø©ØŒ ÙˆÙ…Ø§ Ù„Ø§ ÙŠØ®Ù„Ùˆ Ø¹Ù† Ø§Ù„Ø­ÙˆØ§Ø¯Ø« ÙÙ‡Ùˆ Ø­Ø§Ø¯Ø«.
              </div>
              <div class="ref">
                Ø¥Ø°Ø§ Ø«Ø¨Øª Ø­Ø¯ÙˆØ« Ø§Ù„Ø¹Ø§Ù„Ù… Ø«Ø¨Øª Ø§Ø­ØªÙŠØ§Ø¬Ù‡ Ø¥Ù„Ù‰ Ù…ÙØ­Ø¯ÙØ«ØŒ ÙˆØ¥Ø°Ø§ Ø«Ø¨Øª Ø§Ù„Ù…ÙØ­Ø¯ÙØ« Ù„Ø²Ù… Ù‚ÙØ¯Ù…Ù‡ Ù„Ù‚Ø·Ø¹ Ø§Ù„ØªØ³Ù„Ø³Ù„ ÙˆØ§Ù„Ø¯ÙˆØ±.
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Proofs -->
    <section class="section" id="proofs">
      <div class="section-head">
        <h3>Ø§Ù„Ø£Ø¯Ù„Ø© (Ù…Ù„Ø®Øµ)</h3>
        <button class="pillbtn secondary" type="button" data-jump="#proofs">â†©ï¸</button>
      </div>
      <div class="section-body">
        <div class="note">
          Ù‡Ø°Ø§ Ù…Ù„Ø®Øµ Ù…Ø±ØªØ¨ ÙŠÙ…Ø³Ùƒ Ø§Ù„Ø®ÙŠØ·: Ø«Ø¨ÙˆØª Ø§Ù„Ø­Ù‚Ø§Ø¦Ù‚ â†’ Ø·Ø±Ù‚ Ø§Ù„Ø¹Ù„Ù… â†’ Ø­Ø¯ÙˆØ« Ø§Ù„Ø¹Ø§Ù„Ù… â†’ Ø«Ø¨ÙˆØª Ø§Ù„ØµØ§Ù†Ø¹ â†’ Ù‚ÙØ¯Ù…Ù‡.
        </div>
        <div class="chapters">
          <div class="chapter" id="proof1">
            <div class="ch-head">
              <div class="ch-title">Ù¡) ØªØ±ØªÙŠØ¨ Ø§Ù„Ø§Ø³ØªØ¯Ù„Ø§Ù„</div>
              <button class="toggle" type="button">ÙØªØ­</button>
            </div>
            <div class="ch-body">
              <p>Ù†Ø¨Ø¯Ø£ Ø¨Ø«Ø¨ÙˆØª Ø§Ù„Ø­Ù‚Ø§Ø¦Ù‚ ÙˆØ·Ø±Ù‚ Ø§Ù„Ø¹Ù„Ù…ØŒ Ø«Ù… Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¹Ù‚Ù„ÙŠ Ø¹Ù„Ù‰ Ø­Ø¯ÙˆØ« Ø§Ù„Ø¹Ø§Ù„Ù…ØŒ Ø«Ù… Ø§Ù„ØµØ§Ù†Ø¹ ÙˆÙ‚ÙØ¯Ù…Ù‡.</p>
            </div>
          </div>

          <div class="chapter" id="proof2">
            <div class="ch-head">
              <div class="ch-title">Ù¢) Ø­Ø¯ÙˆØ« Ø§Ù„Ø¹Ø§Ù„Ù…</div>
              <button class="toggle" type="button">ÙØªØ­</button>
            </div>
            <div class="ch-body">
              <p>Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ Ø­Ø§Ø¯Ø«Ø© Ù„ØªØ¨Ø¯Ù„Ù‡Ø§ØŒ ÙˆØ§Ù„Ø£Ø¹ÙŠØ§Ù† Ù„Ø§ ØªØ®Ù„Ùˆ Ø¹Ù† Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶ØŒ ÙˆÙ…Ø§ Ù„Ø§ ÙŠØ®Ù„Ùˆ Ø¹Ù† Ø§Ù„Ø­ÙˆØ§Ø¯Ø« ÙÙ‡Ùˆ Ø­Ø§Ø¯Ø«.</p>
            </div>
          </div>

          <div class="chapter" id="proof3">
            <div class="ch-head">
              <div class="ch-title">Ù£) Ø«Ø¨ÙˆØª Ø§Ù„ØµØ§Ù†Ø¹</div>
              <button class="toggle" type="button">ÙØªØ­</button>
            </div>
            <div class="ch-body">
              <p>Ø§Ù„Ø­Ø§Ø¯Ø« Ù„Ø§ Ø¨Ø¯ Ù„Ù‡ Ù…Ù† Ù…ÙØ­Ø¯ÙØ«ØŒ ÙˆÙŠØ³ØªØ­ÙŠÙ„ Ø£Ù† ÙŠÙØ­Ø¯Ø« Ø§Ù„Ø´ÙŠØ¡ Ù†ÙØ³Ù‡.</p>
            </div>
          </div>

          <div class="chapter" id="proof4">
            <div class="ch-head">
              <div class="ch-title">Ù¤) Ù‚ÙØ¯Ù… Ø§Ù„ØµØ§Ù†Ø¹</div>
              <button class="toggle" type="button">ÙØªØ­</button>
            </div>
            <div class="ch-body">
              <p>Ù„Ùˆ ÙƒØ§Ù† Ø§Ù„ØµØ§Ù†Ø¹ Ø­Ø§Ø¯Ø«Ø§Ù‹ Ù„Ø§Ø­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ù…ÙØ­Ø¯ÙØ«ØŒ ÙÙŠÙ„Ø²Ù… Ø§Ù„Ø¯ÙˆØ± Ø£Ùˆ Ø§Ù„ØªØ³Ù„Ø³Ù„ØŒ ÙˆÙƒÙ„Ø§Ù‡Ù…Ø§ Ø¨Ø§Ø·Ù„.</p>
            </div>
          </div>
        </div>

        <div class="ref">
          Ù…Ù„Ø§Ø­Ø¸Ø©: Ø¹Ù†Ø¯ Ø§Ù„ØªØ¹Ø§Ø±Ø¶ ÙŠÙÙ†Ø¸Ø± Ù„Ù„Ù‚Ø·Ø¹ ÙˆØ§Ù„Ø¸Ù†ØŒ ÙÙŠÙÙ‚Ø¯Ù… Ø§Ù„Ù‚Ø·Ø¹ÙŠ ÙˆÙŠÙØ¤ÙˆÙ‘Ù„ Ø§Ù„Ø¸Ù†ÙŠ Ø¹Ù„Ù‰ ÙˆØ¬Ù‡Ù ØµØ­ÙŠØ­.
        </div>
      </div>
    </section>

    <section class="section" id="footer">
      <div class="section-head">
        <h3>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø³Ø±ÙŠØ¹Ø©</h3>
        <button class="pillbtn secondary" type="button" data-jump="#top">â¬†ï¸</button>
      </div>
      <div class="section-body">
        <div class="note">
          <b>Ø§Ø®ØªØµØ§Ø±Ø§Øª:</b> Ø§Ø¶ØºØ· ğŸ” Ù„Ù„Ø¨Ø­Ø«ØŒ ğŸ‘“ Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©ØŒ ğŸŒ™ Ù„ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø«ÙŠÙ…. <br/>
          <b>Ø·Ø¨Ø§Ø¹Ø©:</b> Ù…Ù† Ø²Ø± ğŸ–¨ï¸ ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ (Ù…ÙˆØ¨Ø§ÙŠÙ„) Ø£Ùˆ Ctrl+P.
        </div>
      </div>
    </section>

  </main>

  <!-- Bottom bar -->
  <nav class="bbar" aria-label="Ø´Ø±ÙŠØ· Ø³Ø±ÙŠØ¹">
    <button type="button" id="bbTop">â¬†ï¸ <span>ÙÙˆÙ‚</span></button>
    <button type="button" id="bbSearch">ğŸ” <span>Ø¨Ø­Ø«</span></button>
    <button type="button" id="bbPrint">ğŸ–¨ï¸ <span>PDF</span></button>
    <button type="button" id="bbMenu">â˜° <span>Ù‚Ø§Ø¦Ù…Ø©</span></button>
  </nav>

  <script>
    // ===== Small utilities =====
    const $ = (s, root=document) => root.querySelector(s);
    const $$ = (s, root=document) => Array.from(root.querySelectorAll(s));
    const storage = {
      get(k, d=null){ try{ return JSON.parse(localStorage.getItem(k)) ?? d; } catch { return d; } },
      set(k, v){ localStorage.setItem(k, JSON.stringify(v)); }
    };

    function scrollToId(id){
      const el = document.getElementById(id);
      if(!el) return;
      el.scrollIntoView({behavior:"smooth", block:"start"});
      el.style.outline = "3px solid rgba(255,215,0,.45)";
      el.style.outlineOffset = "6px";
      setTimeout(()=>{ el.style.outline=""; el.style.outlineOffset=""; }, 700);
    }

    // ===== Jump buttons =====
    $$("[data-jump]").forEach(btn=>{
      btn.addEventListener("click", e=>{
        e.preventDefault();
        const hash = btn.getAttribute("data-jump") || "#top";
        const id = hash.replace("#","");
        scrollToId(id);
      });
    });

    // ===== Accordion behavior (button only) =====
    const chapters = $$(".chapter");
    function syncToggle(ch){
      const btn = $(".toggle", ch);
      if(!btn) return;
      btn.textContent = ch.classList.contains("active") ? "Ø¥ØºÙ„Ø§Ù‚" : "ÙØªØ­";
    }
    function saveOpenChapters(){
      const open = chapters.filter(ch=>ch.classList.contains("active")).map(ch=>ch.id).filter(Boolean);
      storage.set("openChapters", open);
    }
    function restoreOpenChapters(){
      const open = new Set(storage.get("openChapters", []));
      chapters.forEach(ch=>{
        if(open.has(ch.id)) ch.classList.add("active");
        syncToggle(ch);
      });
    }

    chapters.forEach(ch=>{
      const btn = $(".toggle", ch);
      if(!btn) return;
      btn.addEventListener("click", (e)=>{
        e.stopPropagation();
        ch.classList.toggle("active");
        syncToggle(ch);
        saveOpenChapters();
      });
      syncToggle(ch);
    });
    restoreOpenChapters();

    // ===== Open all =====
    const btnOpenAll = $("#btnOpenAll");
    btnOpenAll.addEventListener("click", ()=>{
      const isAllOpen = chapters.every(ch=>ch.classList.contains("active"));
      chapters.forEach(ch=>ch.classList.toggle("active", !isAllOpen));
      chapters.forEach(syncToggle);
      saveOpenChapters();
    });

    // ===== Theme / Modes =====
    const btnTheme = $("#btnTheme");
    const btnReading = $("#btnReading");
    const btnSimple = $("#btnSimple");

    function applyTheme(mode){
      document.documentElement.dataset.theme = mode;
      storage.set("theme", mode);
      btnTheme.textContent = mode === "dark" ? "â˜€ï¸" : "ğŸŒ™";
    }
    function toggleTheme(){
      const cur = document.documentElement.dataset.theme || "light";
      applyTheme(cur === "light" ? "dark" : "light");
    }
    btnTheme.addEventListener("click", toggleTheme);
    applyTheme(storage.get("theme","light"));

    function applyReading(on){
      document.body.classList.toggle("reading", !!on);
      storage.set("reading", !!on);
      btnReading.textContent = on ? "ğŸ“–" : "ğŸ‘“";
      btnReading.title = on ? "Ø¥Ù„ØºØ§Ø¡ ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©" : "ÙˆØ¶Ø¹ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©";
    }
    function toggleReading(){ applyReading(!document.body.classList.contains("reading")); }
    btnReading.addEventListener("click", toggleReading);
    applyReading(storage.get("reading", false));

    function applySimple(on){
      document.body.classList.toggle("simple", !!on);
      storage.set("simple", !!on);
      btnSimple.textContent = on ? "âœ…" : "âœ¨";
      btnSimple.title = on ? "Ù…Ø¸Ù‡Ø± Ø¹Ø§Ø¯ÙŠ" : "Ù…Ø¸Ù‡Ø± Ø¨Ø³ÙŠØ·";
    }
    function toggleSimple(){ applySimple(!document.body.classList.contains("simple")); }
    btnSimple.addEventListener("click", toggleSimple);
    applySimple(storage.get("simple", true)); // default simple ON for comfort

    // ===== Highlight helpers =====
    function clearHighlights(root){
      $$("mark.hl", root).forEach(m=>{
        m.replaceWith(document.createTextNode(m.textContent));
      });
    }
    function highlight(root, term){
      if(!term) return;
      const escaped = term.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
      const re = new RegExp(escaped, "gi");

      const walker = document.createTreeWalker(root, NodeFilter.SHOW_TEXT, {
        acceptNode(node){
          if(!node.nodeValue || !node.nodeValue.trim()) return NodeFilter.FILTER_REJECT;
          const p = node.parentElement;
          if(!p) return NodeFilter.FILTER_REJECT;
          if(["SCRIPT","STYLE"].includes(p.tagName)) return NodeFilter.FILTER_REJECT;
          if(p.closest(".bbar")) return NodeFilter.FILTER_REJECT;
          return NodeFilter.FILTER_ACCEPT;
        }
      });

      const nodes = [];
      while(walker.nextNode()) nodes.push(walker.currentNode);

      nodes.forEach(tn=>{
        const val = tn.nodeValue;
        if(!re.test(val)) return;
        const frag = document.createDocumentFragment();
        let last = 0;
        val.replace(re, (m, off)=>{
          frag.appendChild(document.createTextNode(val.slice(last, off)));
          const mk = document.createElement("mark");
          mk.className = "hl";
          mk.textContent = m;
          frag.appendChild(mk);
          last = off + m.length;
          return m;
        });
        frag.appendChild(document.createTextNode(val.slice(last)));
        tn.parentNode.replaceChild(frag, tn);
      });
    }

    function snippet(el, term, max=160){
      const txt = (el.textContent||"").replace(/\s+/g," ").trim();
      const i = txt.toLowerCase().indexOf(term.toLowerCase());
      if(i < 0) return txt.slice(0, max) + (txt.length>max?"â€¦":"");
      const s = Math.max(0, i-50);
      const e = Math.min(txt.length, i+max);
      return (s>0?"â€¦":"") + txt.slice(s,e) + (e<txt.length?"â€¦":"");
    }

    // ===== Search =====
    const q = $("#q");
    const btnClear = $("#btnClear");
    const results = $("#results");
    const rlist = $("#rlist");
    const rmeta = $("#rmeta");

    function resetVisibility(){
      $$(".section").forEach(sec=>sec.style.display="");
      chapters.forEach(ch=>ch.style.display="");
    }

    function applySearch(){
      const term = (q.value||"").trim();
      clearHighlights(document.body);
      resetVisibility();

      rlist.innerHTML = "";
      results.style.display = "none";
      rmeta.textContent = "â€”";

      if(!term) return;

      highlight(document.body, term);

      // show only sections with hits
      const secs = $$(".section");
      const visibleSecs = secs.filter(sec=>sec.querySelector("mark.hl"));
      secs.forEach(sec=>sec.style.display = visibleSecs.includes(sec) ? "" : "none");

      const found = [];
      visibleSecs.forEach(sec=>{
        const chs = $$(".chapter", sec);
        if(chs.length){
          chs.forEach(ch=>{
            const has = ch.querySelector("mark.hl");
            if(!has){ ch.style.display="none"; return; }
            ch.style.display="";
            ch.classList.add("active");
            syncToggle(ch);
            found.push({
              title: $(".ch-title", ch)?.textContent?.trim() || "Ù†ØªÙŠØ¬Ø©",
              targetId: ch.id || sec.id,
              snippet: snippet(ch, term)
            });
          });
        } else {
          found.push({
            title: $(".section-head h3", sec)?.textContent?.trim() || "Ù†ØªÙŠØ¬Ø©",
            targetId: sec.id,
            snippet: snippet(sec, term)
          });
        }
      });

      saveOpenChapters();

      results.style.display = "";
      rmeta.textContent = `${found.length} Ù†ØªÙŠØ¬Ø©`;
      found.slice(0, 25).forEach((r, idx)=>{
        const div = document.createElement("div");
        div.className = "r-item";
        div.innerHTML = `<p class="rt">${r.title} <span style="opacity:.7">#${idx+1}</span></p><p class="rs">${r.snippet}</p>`;
        div.addEventListener("click", ()=>{
          scrollToId(r.targetId);
        });
        rlist.appendChild(div);
      });
      if(found.length > 25){
        const more = document.createElement("div");
        more.className = "ref";
        more.textContent = "Ø£ÙØ¸Ù‡Ø±Øª Ø£ÙˆÙ„ 25 Ù†ØªÙŠØ¬Ø© ÙÙ‚Ø· â€” Ø¶ÙŠÙ‘Ù‚ Ø§Ù„Ø¨Ø­Ø« Ù„Ù†ØªØ§Ø¦Ø¬ Ø£Ø¯Ù‚.";
        rlist.appendChild(more);
      }
    }

    q.addEventListener("input", applySearch);
    btnClear.addEventListener("click", ()=>{
      q.value = "";
      applySearch();
      q.focus();
    });

    // ===== Bottom bar actions =====
    $("#bbTop").addEventListener("click", ()=>scrollToId("top"));
    $("#bbSearch").addEventListener("click", ()=>{
      scrollToId("top");
      setTimeout(()=>q.focus(), 350);
    });
    $("#bbPrint").addEventListener("click", ()=>window.print());
    $("#bbMenu").addEventListener("click", ()=>{
      // quick menu: cycle modes
      // 1st click: theme, 2nd: reading, 3rd: simple
      const n = storage.get("menuCycle", 0);
      if(n === 0) toggleTheme();
      if(n === 1) toggleReading();
      if(n === 2) toggleSimple();
      storage.set("menuCycle", (n+1)%3);
    });

    // Keyboard shortcuts (desktop friendly)
    document.addEventListener("keydown", (e)=>{
      if(e.key === "/" && !e.metaKey && !e.ctrlKey){
        e.preventDefault();
        scrollToId("top");
        setTimeout(()=>q.focus(), 200);
      }
      if(e.key === "Escape"){
        q.value = "";
        applySearch();
      }
      if(e.key.toLowerCase() === "t") toggleTheme();
      if(e.key.toLowerCase() === "r") toggleReading();
      if(e.key.toLowerCase() === "s") toggleSimple();
    });

  </script>
</body>
</html>
